From d5d957a024cbf73fada9e227eb2b35bd84ab4a42 Mon Sep 17 00:00:00 2001
From: Self-Hosting-Group <selfhostinggroup-git+openwrt@shost.ing>
Date: Mon, 29 Dec 2025 00:00:00 +0000
Subject: [PATCH 2/7] luci-app-upnp: add `UPnP IGD Adjustments` tab

And rearrange as many options

(to merge with prior)

Signed-off-by: Self-Hosting-Group <selfhostinggroup-git+openwrt@shost.ing>
---
 .../luci-static/resources/view/upnp/upnp.js   | 69 ++++++++++---------
 1 file changed, 35 insertions(+), 34 deletions(-)

diff --git a/applications/luci-app-upnp/htdocs/luci-static/resources/view/upnp/upnp.js b/applications/luci-app-upnp/htdocs/luci-static/resources/view/upnp/upnp.js
index 5b664db4c5..7d515e6524 100644
--- a/applications/luci-app-upnp/htdocs/luci-static/resources/view/upnp/upnp.js
+++ b/applications/luci-app-upnp/htdocs/luci-static/resources/view/upnp/upnp.js
@@ -144,6 +144,7 @@ return view.extend({
 		s.addremove = false;
 		s.tab('setup', _('Service Setup'));
 		s.tab('advanced', _('Advanced Settings'));
+		s.tab('igd', _('UPnP IGD Adjustments'));
 
 		o = s.taboption('setup', form.Flag, 'enabled', _('Start service'),
 			_('Start the autonomous port mapping service'));
@@ -162,16 +163,6 @@ return view.extend({
 		o.depends('enable_upnp', '1');
 		o.retain = true;
 
-		o = s.taboption('setup', form.Value, 'download', _('Download speed'),
-			_('Report maximum download speed in kByte/s'));
-		o.depends('enable_upnp', '1');
-		o.retain = true;
-
-		o = s.taboption('setup', form.Value, 'upload', _('Upload speed'),
-			_('Report maximum upload speed in kByte/s'));
-		o.depends('enable_upnp', '1');
-		o.retain = true;
-
 		s.taboption('advanced', form.Flag, 'use_stun', _('Use %s', 'Use %s (%s = STUN)')
 			.format('<a href="https://en.wikipedia.org/wiki/STUN" target="_blank" rel="noreferrer"><abbr title="Session Traversal Utilities for NAT">STUN</abbr></a>'),
 			_('To detect the public IPv4 address for unrestricted full-cone/one-to-one NATs'));
@@ -195,50 +186,60 @@ return view.extend({
 
 		s.taboption('advanced', form.Flag, 'ipv6_disable', _('Disable IPv6 mapping'));
 
-		o = s.taboption('advanced', form.Value, 'notify_interval', _('Notify interval'),
-			_('A 900 s interval sends %s announcements with the min. %s header',
-				'A 900 s interval sends %s (%s = SSDP) announcements with the min. %s (%s = Cache-Control: max-age=1800) header')
-			.format('<abbr title="Simple Service Discovery Protocol">SSDP</abbr>', '<code>Cache-Control: max-age=1800</code>'));
-		o.datatype = 'min(900)';
-		o.placeholder = '900';
-		o.depends('enable_upnp', '1');
+		o = s.taboption('advanced', form.Flag, 'system_uptime', _('Report system instead of service uptime'));
+		o.default = '1';
+		o.depends('to-disable-as-rarely-used', '1');
 		o.retain = true;
 
-		o = s.taboption('advanced', form.Value, 'port', _('SOAP/HTTP port'));
-		o.datatype = 'port';
-		o.placeholder = '5000';
+		s.taboption('advanced', form.Flag, 'log_output', _('Enable additional logging'),
+			_('Puts extra debugging information into the system log'));
+
+		o = s.taboption('advanced', form.Value, 'upnp_lease_file', _('Service lease file'));
+		o.depends('to-disable-as-rarely-used', '1');
+		o.retain = true;
+
+		o = s.taboption('igd', form.Value, 'download', _('Download speed'),
+			_('Report maximum download speed in kByte/s'));
 		o.depends('enable_upnp', '1');
 		o.retain = true;
 
-		o = s.taboption('advanced', form.Value, 'presentation_url', _('Router/presentation URL'),
-			_('Report custom router web interface URL'));
-		o.placeholder = 'http://192.168.1.1/';
+		o = s.taboption('igd', form.Value, 'upload', _('Upload speed'),
+			_('Report maximum upload speed in kByte/s'));
 		o.depends('enable_upnp', '1');
 		o.retain = true;
 
-		o = s.taboption('advanced', form.Value, 'uuid', _('Device UUID'));
-		// o.depends('enable_upnp', '1');
-		o.depends('to-disable-as-rarely-used', '1');
+		o = s.taboption('igd', form.Value, 'model_number', _('Announced model number'));
+		o.depends('enable_upnp', '1');
 		o.retain = true;
 
-		o = s.taboption('advanced', form.Value, 'model_number', _('Announced model number'));
+		o = s.taboption('igd', form.Value, 'serial_number', _('Announced serial number'));
 		o.depends('enable_upnp', '1');
 		o.retain = true;
 
-		o = s.taboption('advanced', form.Value, 'serial_number', _('Announced serial number'));
+		o = s.taboption('igd', form.Value, 'presentation_url', _('Router/presentation URL'),
+			_('Report custom router web interface URL'));
+		o.placeholder = 'http://192.168.1.1/';
 		o.depends('enable_upnp', '1');
 		o.retain = true;
 
-		o = s.taboption('advanced', form.Flag, 'system_uptime', _('Report system instead of service uptime'));
-		o.default = '1';
+		o = s.taboption('igd', form.Value, 'uuid', _('Device UUID'));
+		// o.depends('enable_upnp', '1');
 		o.depends('to-disable-as-rarely-used', '1');
 		o.retain = true;
 
-		s.taboption('advanced', form.Flag, 'log_output', _('Enable additional logging'),
-			_('Puts extra debugging information into the system log'));
+		o = s.taboption('igd', form.Value, 'port', _('SOAP/HTTP port'));
+		o.datatype = 'port';
+		o.placeholder = '5000';
+		o.depends('enable_upnp', '1');
+		o.retain = true;
 
-		o = s.taboption('advanced', form.Value, 'upnp_lease_file', _('Service lease file'));
-		o.depends('to-disable-as-rarely-used', '1');
+		o = s.taboption('igd', form.Value, 'notify_interval', _('Notify interval'),
+			_('A 900 s interval sends %s announcements with the min. %s header',
+				'A 900 s interval sends %s (%s = SSDP) announcements with the min. %s (%s = Cache-Control: max-age=1800) header')
+			.format('<abbr title="Simple Service Discovery Protocol">SSDP</abbr>', '<code>Cache-Control: max-age=1800</code>'));
+		o.datatype = 'min(900)';
+		o.placeholder = '900';
+		o.depends('enable_upnp', '1');
 		o.retain = true;
 
 		s = m.section(form.GridSection, 'perm_rule', _('Service Access Control List'),
-- 
2.52.0.windows.1

