From 0fe7cef5573cad0afef521f03358207476022f3d Mon Sep 17 00:00:00 2001
From: lunatickochiya <125438787@qq.com>
Date: Mon, 15 Sep 2025 18:18:36 +0800
Subject: [PATCH 07/12] mediatek:add cmcc rax3000m emmc custom uboot mod dts
 file

---
 .../mt7981b-cmcc-rax3000m-emmc-ubootmod.dts   | 86 +++++++++++++++++++
 1 file changed, 86 insertions(+)
 create mode 100644 target/linux/mediatek/dts/mt7981b-cmcc-rax3000m-emmc-ubootmod.dts

diff --git a/target/linux/mediatek/dts/mt7981b-cmcc-rax3000m-emmc-ubootmod.dts b/target/linux/mediatek/dts/mt7981b-cmcc-rax3000m-emmc-ubootmod.dts
new file mode 100644
index 0000000000..2586ba716f
--- /dev/null
+++ b/target/linux/mediatek/dts/mt7981b-cmcc-rax3000m-emmc-ubootmod.dts
@@ -0,0 +1,86 @@
+// SPDX-License-Identifier: GPL-2.0-or-later OR MIT
+
+/dts-v1/;
+#include "mt7981b-cmcc-rax3000m.dts"
+
+/ {
+	model = "CMCC RAX3000M eMMC version (custom U-Boot layout)";
+	compatible = "cmcc,rax3000m-emmc-ubootmod", "mediatek,mt7981";
+
+	chosen {
+		bootargs-override = "root=PARTLABEL=rootfs rootwait";
+	};
+};
+
+&gmac0 {
+	nvmem-cells = <&macaddr_factory_2a>;
+	nvmem-cell-names = "mac-address";
+};
+
+&gmac1 {
+	nvmem-cells = <&macaddr_factory_24>;
+	nvmem-cell-names = "mac-address";
+};
+
+&mmc0 {
+	bus-width = <8>;
+	max-frequency = <26000000>;
+	non-removable;
+	pinctrl-names = "default", "state_uhs";
+	pinctrl-0 = <&mmc0_pins_default>;
+	pinctrl-1 = <&mmc0_pins_uhs>;
+	vmmc-supply = <&reg_3p3v>;
+	#address-cells = <1>;
+	#size-cells = <0>;
+	status = "okay";
+
+	card@0 {
+		compatible = "mmc-card";
+		reg = <0>;
+
+		block {
+			compatible = "block-device";
+
+			partitions {
+				block-partition-factory {
+					partname = "factory";
+
+					nvmem-layout {
+						compatible = "fixed-layout";
+						#address-cells = <1>;
+						#size-cells = <1>;
+
+						eeprom_factory_0: eeprom@0 {
+							reg = <0x0 0x1000>;
+						};
+
+						macaddr_factory_24: macaddr@24 {
+							reg = <0x24 0x6>;
+						};
+
+						macaddr_factory_2a: macaddr@2a {
+							reg = <0x2a 0x6>;
+						};
+					};
+				};
+			};
+		};
+	};
+};
+
+&pio {
+	mmc0_pins_default: mmc0-pins {
+		mux {
+			function = "flash";
+			groups = "emmc_45";
+		};
+	};
+
+	mmc0_pins_uhs: mmc0-uhs-pins {
+		mux {
+			function = "flash";
+			groups = "emmc_45";
+		};
+	};
+};
+
-- 
2.43.0

